% -*- mode: latex; eval: (flyspell-mode 1); ispell-local-dictionary: "american"; TeX-master: t; -*-

\documentclass[12pt]{article}


\usepackage{hyperref,amsthm,amsmath,amsfonts,enumerate,stmaryrd}

\newcommand{\bZ}{\mathbb{Z}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\bQ}{\mathbb{Q}}
\newcommand{\Rpos}{\left]0, \infty \right[}

\newcommand{\ttx}{\mathtt{x}}
\newcommand{\tty}{\mathtt{y}}


\newcommand{\bN}{\bZ_{\ge 0}}%
\newcommand{\bNast}{ \bZ_{> 0}} %{\bN \setminus \{ 0 \}}
\newcommand{\bNdeux}{\bZ_{\ge 2}}
\newcommand{\bNtrois}{\bZ_{> 2}}



\newcommand{\seg}[2]{\left\llbracket#1, #2 \right\rrbracket}
\newcommand{\floor}[1]{\left\lfloor #1  \right\rfloor}




\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}

 \theoremstyle{definition}
 \newtheorem{exercise}{Exercise}
% \newtheorem{example}{Example}
\newenvironment{solution}{\begin{proof}[Solution.]}{\end{proof}}

\begin{document}



Let $p$ be a prime.
For each $n \in \bZ$, the \emph{$p$-adic valuation of $n$}, denoted $\nu_p(n)$,
is defined as the supremum of those $v \in \bN$ for which $p^v$ divides $n$:
$$
\nu_p(n) = \sup \left\{ k \in \bZ : n \in p^k \bZ \right\} \, .
$$
Note that $\nu_p(0) = \sup \bN = \sup \bZ = \infty$ and that
$\nu_p(n)$ is a non-negative integer for every $n \in \bZ \setminus \{ 0 \}$.
Equality $\nu_p(pn) = \nu_p(n) + 1$ holds true for every $n \in \bZ$
and
equality $\nu_p(n) = 0$ holds true for every $n \in \bZ \setminus p \bZ$.
% Moreover, for every $k \in \bN$ and every $q \in \bZ$,
% $\nu_p(p^k q) = k$ is equivalent to $q \notin p \bZ$.

% \begin{theorem} \label{thm:mu-nu-equiv}
%   Let $p$ be a prime and let $\mu\colon \bZ \to \bZ \cup \{ \infty \}$.
%   The following two assertions are equivalent:
%    \begin{enumerate}
%      \item  For each $n \in \bZ$, the $p$-adic valuation of $n$ is equal to $\mu(n)$.
%      \item  For each $n \in \bZ$,
%        equality $\mu(p n) = \mu(n) + 1$ holds true and
%        $n \notin p \bZ$ implies $\mu(n) = 0$.
%  \end{enumerate} 
% \end{theorem}
For every $n \in \bN$ and every $a \in \bZ$, put
$$
S(n, a) = \sum_{k = 0}^{n - 1} a^k \, . 
$$

$$
S(n, a) = \frac{a^n - 1}{a - 1} 
$$
Clearly, $S(0, a) = 0$ and $S(n + 1, a) = a S(n, a) + 1$ for every $n \in \bN$  
 
% \begin{equation} \label{eq:ak-1-a-1-Ska} 
%   a^n - 1 = (a - 1) S(n, a) 
% \end{equation} 
% \begin{theorem}
%   Equality
%   $$
%   S(2n, a) = S(n, a)(2 + (a - 1) S(n, a))$$
%   holds true for every $a \in \bZ$ and every $n \in \bN$.
% \end{theorem} 

\begin{exercise}
  This exercise focuses on the computational complexity of the bivariate function~$S$.
  \begin{enumerate}
  \item Check that the following equality holds true for every $a \in \bZ$ and every $n \in \bN$:
    %Compute the $n$th power of the following $2$-by-$2$ matrix 
    $$
    \begin{pmatrix} a & 1 \\ 0 & 1 \end{pmatrix}^n = \begin{pmatrix} a^n & S(n, a) \\ 0 & 1 
    \end{pmatrix}
    \, . 
    $$
  \item  Prove that the following problem can be solved in polynomial time:
    given $a \in \bZ$, $m \in \bNast$, and $n \in \bN$ as input,
    compute $S(n, a) \bmod m$ (warning: the size of $n$ is $O( \log n)$).
\end{enumerate}
\end{exercise}

% $$
% S(n, a) 
% $$

\begin{theorem} \label{thm:2-adic-S}
  Let $a \in \bZ$ be such that $4$ divides $a - 1$.
  For every $n \in \bN$, the $2$-adic valuation of $S(n, a)$ is equal to that of~$n$.
\end{theorem}

\begin{proof}
  We claim that 
  \begin{enumerate}
  \item the $2$-adic valuation of $S(2n, a)$ is equal to that of $2 S(n, a)$ and that  
  \item $S(2n + 1, a)$ is odd.
  \end{enumerate} 
  Theorem~\ref{thm:2-adic-S} is easily deduced from the claims and a simple induction on~$n$.
  It remains to prove the claims.
  Straightforward computations yield
  $$
  S(2n, a) - S(n, a)
  = \sum_{k = n}^{2n - 1} a^k - \sum_{k = n}^{n - 1} a^k
  = \sum_{k = n}^{2n - 1} a^k
  = \sum_{k = 0}^{n - 1} a^{k + n} =  S(n, a) a^n \,,
  $$
  and subsequently,
  $$
  S(2 n, a) = S(n, a) a^n + S(n, a) = S(n, a) (a^n + 1) = 2 S(n, a) \frac{a^n + 1}{2} \,. 
  $$
  Therefore, the first claim holds true if, and only if, $(a^n + 1) \mathbin{/} 2$ is an odd integer.
  More straightforward computations yield
  $$
  a^n + 1  = 2 + (a^n - 1) = 2 + (a - 1) S(n, a) \,, 
  $$
  and subsequently,
  $$
  \frac{a^n + 1}{2} = 1 + \frac{a - 1}{2} S(n, a) \,. 
  $$
  Besides, $(a - 1) \mathbin{/} 2$ is an even integer by assumption.
  Therefore, $(a^n + 1) \mathbin{/} 2$ is an odd integer, and the first claim is proven.
  In particular, it ensures that $S(2n, a)$ is even,
  whence
  $$S(2n + 1, a) = 1 + S(2n, a) a$$
  is odd and the second claim is also proven.
\end{proof}

% \begin{theorem}
%   Let $a \in \bZ$ and let $m \in \bN$.
%   For every $n \in \bN$, $S(n \bmod 2^m, a) \bmod 2^m  = S(n, a) \bmod 2^m$
%   If $4$ divides $a - 1$ then
%   $$\left\{ S(n, a)\bmod 2^m : n \in \bZ \right\}$$
%   is a complete residue system modulo $2^m$.
%   % For every $n$, $j$, $m \in \bN$,
%   % $S(i, a) - S(j, a) \in 2^m \bZ$ is equivalent to $i - j \in  2^m \bZ$.
% \end{theorem}

% \begin{proof}
  
% \end{proof}

\begin{exercise}
   Let $m \in \bNdeux$.
   This exercise focuses on the multiplicative group of integers modulo $2^m$.
   \begin{enumerate}
   \item Check that the multiplicative group of integers modulo $2^m$ is of order $2^{m - 1}$.
   \item Prove that the multiplicative order of $5$ modulo $2^m$ is equal to $2^{m - 2}$
     (hint: Theorem~\ref{thm:2-adic-S}).
     % (\emph{i.e.}, prove that for every  $i$, $j \in \bN$,
     %$5^i - 5^j \in 2^m \bZ$ is equivalent to $i - j \in 2^{m - 2} \bZ$).       
   % \item Let $n \in \bZ$.
   %   Prove that $n$ is odd if, and only if,
   %   there exist $\varepsilon \in \{ - 1, + 1 \}$ and $k \in \bN$ such that
   %   $n$ is congruent to $\varepsilon 5^k$ modulo $2^m$.
%     (hint: if $n$ is odd then there exists $\varepsilon \in \{ - 1, + 1 \}$ such that $4$ divides $n - \varepsilon$).
   \item Describe the structure of the multiplicative group of integers modulo $2^m$ (hint: $5$ and $-1$).
 \end{enumerate}
\end{exercise}

\begin{exercise}
  The aim of this exercise is to generalize Theorem~\ref{thm:2-adic-S}.
  Let $a \in \bZ$ and let $n \in \bN$.
  \begin{enumerate}
  \item Prove that $a$ is odd if, and only if, $8$ divides $a^2 - 1$.
  \item Prove that $S(2 n, a) = (a + 1) S(n, a^2)$ (warning: $a = - 1$ may happen) and that $S(2n + 1, a)$ is odd. 
  \item Compute the $2$-adic valuation of $S(n, a)$  (hint: $0$ or $\nu_2(n) + \nu_2(a + 1) - 1$).
  \end{enumerate}
\end{exercise}

\begin{theorem} \label{thm:DL-Sn-am}
  For every $a \in \bZ$ and every $n \in \bN$,
  $S(n, a)$ is congruent to
  $$
  n + \frac{n(n - 1)}{2}  {(a - 1)}
  $$ modulo ${(a - 1)}^2$.
 \end{theorem}

 \begin{proof}
   Since $S(n, 1) = n$ for every $n \in \bN$,
   Theorem~\ref{thm:DL-Sn-am} trivially holds true in the case where $a = 1$.
   It remains to deal with the case where $a \ne 1$.
   Let $a \in \bZ \setminus \{ 1 \}$ be fixed and let $T\colon \bZ \to \bZ$ be defined by
   $$
   T(n) =  1 + n (a - 1) + \frac{n(n - 1)}{2} {(a - 1)}^2 
   $$
   for every $n \in \bZ$.
   For each $n \in \bZ$,
   $T(n + 1)$ is congruent to $a T(n)$ modulo ${(a - 1)}^3$ because 
   %Since $T$ satisfy the recurrence relation 
   $$
   T(n + 1) = a T(n) - \frac{n(n - 1)}{2} {(a - 1)}^3 \,.
   $$
   It thus follows from a straightforward induction on $n$ that
   $a^n$ is congruent to $T(n)$ modulo ${(a - 1)}^3$ for every $n \in \bN$.
   (The latter congruences can also be directly deduced from the binomial theorem.)
   Therefore,
   $$S(n, a) = \frac{a^n - 1}{a - 1} % \mathbin{/} (a - 1)
   $$
   is congruent to
   % $$(T(n) - 1) \mathbin{/} (a - 1) = n + \frac{n(n - 1)}{2}  {(a - 1)}
   % Since
   $$
   \frac{T(n) - 1}{a - 1} = n + \frac{n(n - 1)}{2}  {(a - 1)} 
   $$
   modulo
   $$
   \frac{{(a - 1)}^3}{a - 1} = {(a - 1)}^2
   $$ for every $n \in \bN$.
%    Let us now assume $a \ne 1$.   Since $a = 1 + (a - 1)$, the binomial theorem yield
%    $$
%    a^n = \sum_{k = 0}^{n - 1} \binom{n}{k} {(a - 1)}^k \,. 
%    $$
%    Besides, we have
%    $\binom{n}{0} = 1$,
%    $\binom{n}{1} = n$,
%    $\binom{n}{2} = \frac{n(n - 1)}{2}$, and
%    $\binom{n}{k} \in \bZ$ for $k = 0$, $1$, \ldots, $n$.
%    It follows  $a^n$ is congruent to
%    $$
%    a^n = 1 + n (a - 1) + \frac{n(n - 1)}{2} {(a - 1)}^2 + {(a - 1)}^3 q_n  
%    $$
%    modulo ${(a - 1)}^3$.
%    Sin
%    It follows that
%    $$
%    S(n, a)
%    $$
%    is congruent t
   
%    (Although Theorem~\ref{thm:DL-Sn-am} can be easily deduced from the binomial theorem,
%    we choose to follow another path.)
%    Put
%    $$
%    T = \sum_{k = 0}^{j - 1} S(k, a)  
%    $$
%    and 
%    $$
%    N = \frac{n(n - 1)}{2} \, .
%    $$
%    Straightforward computations yield 
%    $$
%    S(n, a) - n
%    = \sum_{k = 0}^{n - 1}  (a^ k  - 1)
%    = \sum_{k = 0}^{n - 1} (a - 1) S(k, a)
%    = (a - 1) T \,, 
% %   \left( t + N
%    $$
%    and subsequently  
%    $$
%    S(n, a) - n - N (a - 1)  = (a - 1) (T - N) \, . 
%    $$
%    Therefore, Theorem~\ref{thm:DL-Sn-am} holds true if, and only if, $a - 1$ divides $T - N$.
%    Since 
%    $$
%    N= \sum_{k = 0}^{n - 1} k \,, 
%    $$
%    $T - N$ can be written as 
%    $$
%    T - N = \sum_{k = 0}^{n - 1} \left( S(k, a) - k \right) = \sum_{k = 0}^{n - 1} \sum_{j = 0}^{k - 1} (a^j - 1) \, .
%    $$
%    Besides, $a - 1$ divides $(a - 1) S(j, a) = a^j - 1$  for every $j \in \bN$.
%    It follows that $a - 1$ divides $T - N$, as desired.
 \end{proof}

 \begin{exercise}
 \begin{enumerate}
 \item Let $f$ be a polynomial with integer coefficients and let $a \in \bZ$.
   Prove that $f(a)$ is congruent of $f(0) + f'(0) a$ modulo $a^2$.
 \item Find another proof for Theorem~\ref{thm:DL-Sn-am}.
 \end{enumerate}
\end{exercise}

\begin{theorem} \label{thm:p-adic-S}
  Let $p$ be an odd prime and let $a \in \bZ$ be such that $p$ divides $a - 1$.
  For every $n \in \bN$, the $p$-adic valuation of $S(n, a)$ is equal to that of~$n$.
\end{theorem}

\begin{proof}
  (The proof of Theorem~\ref{thm:p-adic-S} is organized in the same way as that of Theorem~\ref{thm:2-adic-S}.)
  We claim that
  \begin{enumerate}
  \item $p$ divides $S(n, a)$ if, and only if, $p$ divides $n$ and that
  \item the $p$-adic valuation of $S(p n, a)$ is equal to that of $p S(n, a)$.
  \end{enumerate}
  Theorem~\ref{thm:p-adic-S} is easily deduced from the claims and a simple induction on~$n$.
  It remains to prove the claims.

  Put
  $$
  T(x) = \sum_{k = 0}^{p - 1} S(n k, x) 
  $$
  The first claim follows from Theorem~\ref{thm:a-1-divides-Sna-n};
  it remains to prove the second one.
  Since $S(n, 1) = n$ for every $n \in \bN$,
  both claims (and Theorem~\ref{thm:p-adic-S}) trivially hold true in the case where $a = 1$.
  Hence, we may assume $a \ne 1$.
  Since Equation~\eqref{ } holds true for $k = n$, for $k = np$ and for $( = p$ and we have 
 % $$
 % S(np, a)
 % = \frac{a^{pn} - 1}{a - 1}
 % = \frac{{(a^n)}^p - 1}{a - 1} 
 % = \frac{(a^n - 1)S(p, a^n)}{a - 1}
 % = S(n, a) S(p, a^n)
\begin{align*}
(a - 1) S(np, a)
& = a^{pn} - 1 \\
& = {(a^n)}^p - 1  \\
& = (a^n - 1)S(p, a^n) \\
& = (a - 1) S(n, a) S(p, a^n) 
\end{align*}
whence
$$
S(pn, a) = S(n, a) S(p, a^n) \, . 
$$


Therefore, it suffices to prove that the $p$-adic valuation of $S(p, a^n)$ is equal to~$1$.
Straightforward computations yield
$$
S(p, a^n) - p 
= \sum_{k = 0}^{p - 1} (a^{n k} - 1)
= (a - 1) \sum_{k = 0}^{p - 1} S(n k, a)  
$$
$$
(a - 1) S(np, a)
 = a^{pn} - 1
 = {(a^n)}^p - 1 
 = (a^n - 1)S(p, a^n)
 = (a - 1) S(n, a) S(p, a^n)
 $$
 
$$
\sum_{k = 0}^{p - 1} k = \frac{p(p - 1)}{2} 
$$

$$
\sum_{k = 0}^{p - 1} k = \frac{p(p - 1)}{2} 
$$% $$
$$
\sum_{k = 0}^{p - 1} k = \frac{p(p - 1)}{2} 
$$
$$
\sum_{k = 0}^{p - 1} S(n k, a) = n \frac{p(p - 1)}{2} + \sum_{k = 0}^{p - 1} \left( S(n k, a) - n k \right)  
$$
\end{proof}

\begin{exercise}
 Let $a \in \bZ$.
  \begin{enumerate}
  \item Prove that the $4$ divides $a - 1$ if, and only if, $2$-adic valuation of $S(2, a)$ is equal to~$1$. 
  \item Let $p$ be a prime.
    Prove that $p$ divides $a - 1$ if, and only if, the $p$-adic valuation of $S(p, a)$ is positive (hint: Fermat).
  \end{enumerate}
\end{exercise}



\begin{exercise}
  The aim of this exercise is to construct proofs for Theorems~\ref{thm:2-adic-S} and~\ref{thm:p-adic-S}
  that strictly follow the line of the original paper \cite{HullDobell62}.
  \begin{enumerate}
  \item Let $k$, $p \in \bNdeux$.
    Prove that the following three assertions are equivalent:
    $p^{k - 1} \le k$, $p^{k - 1}$ divides $k$, and $k = p = 2$. 
  \item Let $a \in \bZ$ and let $n \in \bNast$.
    Prove
   $$
  \frac{S(n, a)}{n}  = 1 + \sum_{k = 2}^n \binom{n - 1}{k - 1} \frac{{(a - 1)}^{k - 1}}{k} \, . 
  $$
  (hint: $\binom{n}{k} = \frac{n}{k} \binom{n - 1}{k - 1}$).
\item Find new proofs for Theorems~\ref{thm:2-adic-S} and~\ref{thm:p-adic-S}
  (hint: rational numbers have $p$-adic valuations too).
  \end{enumerate}
\end{exercise}

\bibliographystyle{plain}
\bibliography{gen}
\end{document} 
% Theorem~\ref{ } is an \emph{ad hoc} lemma that provides a backbone for the poo The following 
% \begin{theorem}
%   Let $p$ be a prime and let $T\colon \bZ \to \bZ$ be such that for every $n \in \bZ$,
%   \begin{enumerate}
%   \item $p$ divides $T(n) - n$ and 
%   \item $p^2 T(n)$ divides $T(pn) - p T(n)$.
%   \end{enumerate} 
%   For each $n \in \bZ$, the $p$-adic valuation of $T(n)$ is equal to that of~$n$.
% \end{theorem}

% \begin{proof}
%  \end{proof} 
% $$
% T(p^k q) = p^k T(q)(1 + i p)
% $$

% $$
% T(p^{k + 1}) = p^{k + 1} T(q)(1 + j p)
% $$

% $$
% T(p^{k + 1} q) - p T(p^k q) = p^{k + 1}T(q)(1 + (j - i) p)
% $$

\begin{proof}
  Let $n \in \bZ$ be fixed.
  We prove by induction on $k$ that for every $k \in \bN$,
  $p^k$ divides $T(n)$ if, and only if, $p^k$ divides~$n$.
  If $k = 0$ then $p^k = 1$ divides both $T(n)$ and~$n$.
  Therefore, the basis of our induction holds.
  Let us now assume $k \ge 1$.

  $$
  T(p^v q) - p^v q =
  \sum_{k = 1}^v p^{v - k} \left(  T(p^k q) - p T(p^{k - 1} q)  \right) 
  $$

  
  First, assume that $p$ does not divide~$n$.
  Then, $p$ does not divides $T(n)$ either because of the first assumption.
  Let us now assume that $p$ divides~$n$.
  
  
\end{proof}

$$
\sigma(p^{k + 1} q) - p^{k + 1}q = (\sigma(p^{k + 1} q) - p \sigma(p^k q)) - p (\sigma(p^k q) + p^k q) 
$$

 % $$
 % \frac{S(pn, a)}{S(n, a)}
 % = \frac{a^{pn} - 1}{a^n - 1}
 % = \frac{\left( a^n \right)^p - 1}{a^n - 1}
 % = \sum_{k = 0}^{p - 1} a^{nk}
 % $$

\begin{proof}
 
  For each $n \in \bZ$, let $\nu(n)$ denote the $p$-adic valuation of~$n$.
  The first assumption ensures $\nu(\sigma(0)) = \nu(\sigma(0)) + 1$.
  It follows $\nu(\sigma(0)) = \infty = \nu(0)$, as desired.
  It remains to prove $\nu(\sigma(n)) = \nu(n)$ for every $n \in \bZ \setminus \{ 0 \}$.
  Let $q \in \bZ \setminus p \bZ$.
  A straightforward induction on $k$ yields $\nu(\sigma(p^k q)) = k$ for every $k \in \bN$.
  Since $\nu(p^k q) = k$ for every $k \in \bN$ and since 
\end{proof}

\begin{exercise}
Put
$$
P(n) = S(n, 5) = \frac{5^n - 1}{4}
$$
for every $n \in \bN$.
\begin{enumerate}
  \item Prove $P(2n) = 2 P(n) (2 P(n) + 1)$ for every $n \in \bN$.
  \item Prove that $P(n)$ 
  \item Prove
  $$
  P(2^v n ) = 2^v P(n) \prod_{i = 0}^{v - 1}  (2 P(2^i n) + 1)  
  $$
  \item Prove that 
  \end{enumerate}
\end{exercise} 

%\include{python}

\end{document} 
3^{k - 1} > k$

$2^k > k$
$$
S(n, 1 + 2\ttx) = 
$$

$$
S(n, 1 + \ttx) - n = n \ttx \sum_{k = 2}^n \binom{n - 1}{k - 1} \frac{\ttx ^{k - 2}}{k} \, .
$$

$$
S(n, 1 + \ttx)
= \left(1 + \frac{n - 1}{2}  \ttx \right) n
=
  n \ttx  \sum_{k = 3}^n \binom{n - 1}{k - 1} \frac{\ttx^{k - 2}}{k}\, .
$$
\begin{theorem}
\end{theorem}

$$
S(2n, a) = 
$$

\begin{theorem}
  Let $a \in \bZ$ and let $n \in \bN$.
  If $4$ divides $a - 1$ then the $2$-adic valuation of $S(n, a)$ is equal to that of~$n$.
\end{theorem}
$$
S(2^k n, a) = 
$$
\begin{lemma}
  \begin{enumerate}
  \item For each $k \in \bN$, $2^k$ is larger than~$k$.
  \item For each $k \in \bZ_{\ge 2}$, $3^{k - 1}$ is larger than~$k$.
  \end{enumerate} 
  % For every $k \in \bZ_{k \ge 3}$ and every $p \in \bZ_{\ge 2}$,
  % $p^{k - 1}$ is larger than $k$ is equivalent to $k = p = 2$.
\end{lemma}

Put $d = \frac{1}{2} (a - 1)$.

% $$
% a^{2k} \equiv 
% $$
$$
a^{2n} - 1 = (a^n - 1)(a^n + 1)
$$
$$
S(2n, \ttx)= S(n, \ttx) (\ttx^n + 1)
$$
$$
S(2n, \ttx)  = (\ttx + 1) S(n, \ttx^2) 
$$

$$
S(2^k n, \ttx)  = S(n, \ttx) \prod_{j = 0}^{k - 1} \left( \ttx^{2^j n } + 1 \right) 
$$

$$
S(2^k n 
$$
$$
S(2 n, \ttx) -  (\ttx + 1) n
= (\ttx + 1) \left( S(n, \ttx^2)  - n \right)  
= (1 + \ttx) S(n, \ttx^2)  \prod_{j = 0}^{k - 1} \left( \ttx^{2^{j +1 }  n } + 1 \right) 
$$
$$
S(2^{k + 1} n, \ttx) 
= (1 + \ttx) S(2^k n, \ttx^2)  
= (1 + \ttx) S(n, \ttx^2)  \prod_{j = 0}^{k - 1} \left( \ttx^{2^{j +1 }  n } + 1 \right) 
$$

$$
S(n, a) = S(n, \ttx^2)  
$$

If $m$ is even then
% $$
% a^2  = {(2 d + 1)}^2 =  4 d^2 + 4 d + 1 
% $$
% $$
% a^m \equiv 
% $$
$$
\frac{a^m + 1}{2}  \equiv 1 \pmod{d}
$$

 %= \frac{a^{2n} - 1}{a - 1} 
\begin{theorem}
  Let $a \in \bZ$ and let $n \in \bN$.
  If $a$ is odd then the $2$-adic valuation of $S(n, a) - \frac{1}{2} (a + 1) n$ is not less than that of 
  $\frac{1}{2}(a - 1) n$. 
\end{theorem}

\begin{proof}
  % Let $p \in \bZ_{\ge 2}$ be fixed.
  % If $k = 2$ then $p^{k - 1} \le k$ is clearly equivalent to $p = 2$.
  % It remains to prove $p^{k - 1} > k$ for every $k \in \bZ_{\ge 3}$. 
  We proceed by induction on~$k$.
  In the case where $k = 3$, we have $p^{k - 1} = p^2 \ge 2^2 = 4 > 3 = k$,
  and thus the basis of our induction holds.
  Let $p \in \bZ_{\ge 2}$ and let $k \in \bNast$.
  Since $p$ is larger than $1$, $p^k$ is larger than $p^{k - 1}$.
  It follows $p^k \ge p^{k - 1} + 1$ because both $p^k$ and $p^{k - 1}$ are integers.
  Therefore, $p^{k - 1} > k$ implies $p^k > k + 1$.
  If  
  and thus induction applies.
 \end{proof} 

 \begin{theorem}
   Let $a \in \bZ$ and let $n \in \bN$.
   \begin{enumerate}
   \item  If $p$ is an odd prime factor of $a - 1$ then
     the $p$-adic valuation of $S(n, a) - n$ is not less than that of $ (a - 1) n$.
   \item If $a$ is odd then
     the $2$-adic valuation of $S(n, a) - n$ is not less than that of $\frac{1}{2} (a - 1) n$.
   \end{enumerate}
 \end{theorem} 

 \begin{proof}
   Let $b$ be a real number.
   
  % $$
  %  {(1 + x)}^n  = \sum_{k = 0}^n \binom{n}{k} x^k
  % $$
   Let $b$ be a non-zero real number.
  Since $\binom{n}{0} = 1$ and $\binom{n}{1} = n$, the binomial theorem yields
  $$
  {(1 + b)}^n  = 1 + n b + b^2  \sum_{k = 2}^n \binom{n}{k} b^{k - 2} \, .
  $$
  It follows
  $$
  S(n, 1 + b) = \frac{{(1 + b)}^n - 1}{b} = b   \sum_{k = 2}^n \binom{n}{k} b^{k - 2} \, .
  $$

  $$
  {(1 + x)}^n  = 1 + n x + x^2  \sum_{k = 2}^n \binom{n}{k} x^{k - 2}
  $$
  Put $b = a - 1$. 
  The binomial theorem yields
  $$
  a^n  = {(1 + b)}^n  = \sum_{k = 0}^n \binom{n}{k} b^k
  $$
  $$
  a^n = 1 + b n + b^2 \sum_{k = 2}^n \binom{n}{k} b^{k - 2} \,.
  $$

  $$
  a^n = 1 + b n + b^2 n \sum
  $$
  Besides,
  we have $b \ne 0$, $\binom{n}{0}  = 1$, $\binom{n}{1} = n$, and
  $\binom{n}{k} = \frac{n}{k} \binom{n - 1}{k - 1}$
  for each $k \in \{ 1, 2, \dotsc, n \}$.
  It follows 
 $$
 S(n, a) - n 
= \frac{a^n - 1}{b} - n 
= b \sum_{k = 2}^n \binom{n}{k}  b^{k - 2}
= b n \sum_{k = 2}^n \binom{n - 1}{k - 1} \frac{b^{k - 2}}{k} 
\, .
%= \frac{1}{2} bn \sum_{k = 2}^n \mu_k \, . %2 n^{- 1} \lambda_k  b^{k - 2}
$$
Therefore, it suffices to check that the $p$-adic valuation of the rational number 
$\mu_k$ is non-negative for each $k \in \{ 2, 3, \dotsc, n \}$.
$$
\frac{ k \lambda_k }{n}  = \binom{n - 1}{k - 1} 
$$

$k \lambda_k n^{-1}$ is an integer.
$$
\mu_k  = \frac{2p^{k - 2}}{k} \frac{k \lambda_k}{n} \left(  \frac{b}{p}  \right)^{k - 2}  
$$

If $p^{k - 1}$ does not divide $k$ then the $p$-adic valuation of $2 p^{k - 2} k^{-1}$ is non-negative. 
If $p^{k - 1}$ divides $k$ then Lemma~\ref{ } ensures that $2 p^{k - 2} k^{-1} = 1$
 
  
 
\end{proof}

\begin{theorem}
 \end{theorem}
 \begin{proof}
  Let $p \in \left]0, \infty \right[$ be fixed and let $f\colon \bR \setminus \{ 0 \} \to \bR$ be defined by:
  $$
  f(t) = \frac{p^{t - 1}}{t}
  $$
  for every $t \in \bR \setminus \{ 0 \}$.   
  The derivative of $f$ is given by:
  $$
  f'(t) = \left( \ln p - \frac{1}{t} \right) f(t)
  $$
  for every $t \in \bR \setminus \{ 0 \}$.
  In particular, $f'$ is positive on 
If $p \ge 2$ and $t \ge 2$ 
  $f(k) > p / 2$ for every $k \in \bZ_{\ge 2}$
  
  Assume $p \ge 2$ and $t \ge 2$
  % $$
  % \exp((t - 1) \ln p)
  % $$
  
\end{proof} 

$$
S(n, a)  = \frac{a^n - 1}{a - 1}
$$

$$
S(n, 1)  = n
$$

$$
S(n + 1, a) = a S(n, a) + 1 
$$

$$
S(0, a) = 0
$$
$$
{(1 + 2p + p^2)}^n \equiv 1 + 2p n  \pmod{p^2}
$$

$$
a^{2n} \equiv 1 + 2n (a - 1) \pmod{{(a - 1)}^2}
$$
\begin{lemma}
  Let $m$, $a \in \bZ$ be such that $m \ne 0$ and $\rho'(m)$ divides~$a$.
  There exists $a' \in \bZ$ such that both $4$ and $\rho(m)$ divides $a'$.
\end{lemma}

\begin{proof}
\end{proof}


$$
S(p, a^n) 
$$
% $$
% a^n = 1 + (a - 1) S(n, a)
% $$
$$
a \equiv 1 \pmod{b}
$$
$$
S(n, a) \equiv S(n, 1) = n \pmod{b} 
$$
$$
S(n, a) b \equiv n b \pmod{b^2} 
$$
$$
a^n = 1 + S(n, a) b \equiv 1 + n b \pmod{b^2} 
$$
$$
S(p, a^n) \equiv S(p, 1 + nb) \pmod {b^2}
$$


\begin{proof}
  Put
  $$
  a \equiv m \pmod{4} 
  $$
  $$
  (m - 1)(m + 1)(a - m)
  $$
  $$
  k = (m + 2)a 
  $$
  $$
  a + k m 
  $$

  Put
  $$
  a' = \begin{cases}
    a - m & \textrm{if $a \equiv m \pmod{4}$ and } \\
    {(1 + m)}^2 a & \text{otherwise} \\
    \end{cases} 
  $$
  % $$
  % a' = \begin{cases}
  %   {(1 + m)}^2 a & \text{if $4$ divides $a$ or if $m$ is odd and} \\
  %   a + m & \text{otherwise.}
  %   \end{cases} 
  %   $$
  Assume $a \not\equiv m \pmod{4}$.
  Then, $m$ is odd or $4$ divides $a$.
  Either way, $4$ divides ${(1 + m)}^2 a$.
  Therefore, 
  Since both $a - m$ and  ${(1 + m)}^2 a$ are congruent to $a$ modulo $m$,
  $a'$ is also congruent to $a$ modulo $m$, and thus
  $S(n, a')$ and $S(n, a)$ are congruent modulo $m$ for every $n \in \bN$.
  If $4$ divides $a$ or if $m$ is odd then $4$ divides ${(1 + m)}^2 a$.
  If $4$ does not divide $a$ and if $m$ is even then $a \equiv m \equiv 2 \pmod{4}$ and $4$ divides $a + m$.
  If $m$ is odd or if $4$ divides 
  ${(1 + m)}^2$
  If $m$ is odd then $4$ divides $a$ 
  Assume that $m$ is even and that $4$ does not divide ${(1 + m)}^2 a$.
  Then, $m$ 
  $m$ is even and $4$ d
  $a + m$ 
  Put 
  $$
  a'
  = \begin{cases}
    {(1 + m)}^2 a  & \text{if $m$ is odd,} \\
    a & \textrm{if $4$ divides $a$, and } \\
    a + m & \textrm{otherwise.}  
    \end{cases} 
  $$
\end{proof}
\begin{theorem}
  Let $n \in \bNast$, let $p \in \bN$, and let $q \in \bZ$.
  % \begin{enumerate}
  % \item $S(n, 1 + p q)$ divides $S(n p, 1 + p q)$.
  For every $n \in \bNast$, every $p \in \bN$,  and every $q \in \bZ$,
  the congruence 
  If $n$ is even or if $p$ is odd or if $q$ is even then
    $$
    \frac{S(n p, 1 + p q)}{S(n, 1 + p q)} \equiv p \pmod{p^2}
    $$
   holds true unless $p = 2$ and both $n$ 
\end{theorem}

$$
a^n - 1 = (a - 1) S(n, a) 
$$
$$
S(n p , a)
= \frac{a^{np} - 1}{a - 1}
= \left( \frac{a^{np} - 1}{a^n - 1} \right) \left( \frac{a^n - 1}{a - 1} \right)
= S(p, a^n) S(n, a)
$$

%1 + a^n
$$
{(1 + a)}^n \equiv 1 + n a + \frac{n(n - 1)}{2} a^2  \pmod{a^3}
$$

$$
S(n, 1 + a) \equiv n + \frac{n(n - 1)}{2} a  \pmod{a^2}
$$

$$
n (n - 1) a = 2 k n^2 
$$

$$
(n - 1) a = 2 k n 
$$

$$
\frac{S(p, 1 + p q)}{p} = 1 + \frac{1}{2} p (p - 1)q \pmod{p}  
$$

$$
2 + p (p - 1) q = 2 k p 
$$

$$
2 = p (2 k + (p - 1) q) 
$$

$$
1 = 2k + q 
$$
\begin{theorem}
  Let $a \in \bZ$ be such that $4$ divides $a - 1$.
  For every $n \in \bN$,
  the $2$-adic valuation of $S(n, a)$ is equal to that of~$n$.
\end{theorem}

\begin{theorem}
  Let $a \in \bZ$ and let $p \in \bN$ be such that $p$ is odd and $p$ divides $a - 1$.
  For every $n \in \bN$,
  $p S(n, a)$ divides $S(p n, a)$ and the quotient is congruent to $1$ modulo~$p$.
\end{theorem}

\begin{proof}
  $a = 1$.
  Then, we have $S($
  
  Let us now assume $a \ne 1$
  $$
  {(1 + b)}^n \in  1 + n b + \frac{n (n - 1)}{2} b^2 + b^3 \bZ
  $$
  
  $$
  S(n, 1 + b) = \frac{{(1 + b)}^n - 1}{b} \in n + \frac{n(n - 1)}{2} b + b^2 \bZ 
  $$

\end{proof}

\begin{theorem}
  Let $a \in \bZ$ and let $p$ be an odd prime factor of $a - 1$.
  For every $n \in \bN$, the $p$-adic valuation of $S(n, a)$ is equal to that of~$n$.
\end{theorem}

\begin{exercise}
  Let $m \in \bNast$ and let $T\colon \bN \to \bZ$.
  \begin{enumerate}
  \item For every $n$, $n' \in \bN$, $T(n) \equiv T(n')$ is equivalent to $n \equiv n' $.
  \item For every $n$, $n' \in \bN$, $T(n) \equiv T(n')$ implies $n \equiv n'$.
  \item For every $K \subseteq \bN$, $K$ is complete residue system modulo $m$ if, and only if, $T(K)$ is a complete residue system modulo~$m$.
  \item There exists $K \subseteq \bN$ such that $T(K)$ is a complete residue system modulo $m$ and
    for each $n \in \bN$, $T(n + m) \equiv T(n)$.
  \end{enumerate}
  
\end{exercise}

$$
S(n, a) = \sum_{k = 0}^{n - 1} a^k 
$$
% \begin{theorem}
%   Let $n \in \bN$ and let $a \in \bZ$ be such that $4$ divides $a - 1$.
% \end{theorem}

$$
S(n, a) \equiv 1 + (n - 1) a \pmod{2} 
$$

\begin{theorem}
  $S(n, a)$ is odd if, and only if, $n a$ is odd or $n$ is positive and $a$ is even. 
\end{theorem}


\begin{theorem}
  Let $n \in \bN$ and let $a \in \bZ$.
  If $a$ is even and if $n > 0$ then $S(n, a)$ is odd.
  If $a$ is odd and if $n$ is even then
  $$\nu_2(S(n, a)) = \nu_2(n) + \nu_2(a + 1) - 1 \, .$$
\end{theorem}



$a n = $

\begin{proof}
  Assume that $a$ is even.
  Then, 
  
  If $a = 1$ 
\end{proof}


$$
S(2 n, a) = S(n, a) S(2, a^n) = S(n, a) (1 + a^n)
$$

$$
S(2 n, a) = S(n, a^2) S(2, a) = S(n, a^2) (1 + a)
$$

\begin{align*} 
  \frac{S(2n, a)}{S(n, a)}
  & = \frac{a^{2n} - 1}{a - 1} \frac{a - 1}{a^n - 1} \\
  & = \frac{a^{2n} - 1}{a^n - 1} \\
  & = S(2, a^n) = 1 + a^n
\end{align*} 

$$
S(2 n, a) 
$$


\end{document}

$$
{(1 + a)}^n \equiv 1 + n a  \pmod{a^2}
$$

$$
{(1 + p a)}^n \equiv 1 + 2 p n a \pmod{p^2 a}
$$

$$
{(1 + a)}^n \equiv 1 + n a + \frac{(n - 1) n}{2} a^2 \pmod{a^3}
$$

$a$ is even

$$
{(1 + p a)}^p \equiv 1 +  p^2 a   \pmod{p^3 a} 
$$

$$
a = p^k(a + p a b)
$$
$$
\left(1 + p^{k + 1} a + p^{k + 2} a b \right)^p =
 1 + p^{k + 2} a \pmod{p^{k + 3} a }
$$

$$
\left(1 + \ttx \right)^n  = 1 + n \ttx + \frac{(n - 1) n}{2} \ttx^2 + \ttx^3 R(n, \ttx)   
$$

$$
Q(n, \ttx) = \frac{(n - 1) n}{2} \ttx + p \ttx^2 R(n, p \ttx) 
$$

\begin{align*}
  \left(1 + p \ttx \right)^n
  & = 1 + n (p \ttx) + \frac{(n - 1) n}{2} {(p \ttx)}^2 + {(p \ttx)}^3 R(n, p \ttx)  \\
  & = 1 + p n \ttx + p^2 \ttx Q(n, \ttx)
\end{align*} 

$$
\left(1 + p \ttx \right)^{n + 1}
=
(1 + p \ttx ) (1 + p n \ttx + p^2 \ttx Q(n, \ttx)) = 1 + p(n + 1) \ttx 
$$
% $$
% \left( 1 + p \ttx \right)^{pn}
% = 1 + p^2 n \ttx + p^3 \ttx^2 \left( \frac{1}{2}(pn - 1) n + \ttx R(p n, p \ttx) \right)  
% $$
  
% $$
% F(n, \ttx) = \left( 1 + \ttx \right)^n - 1 - n\ttx 
% $$

% $$
% F(0, \ttx) = 0
% $$
% and 
% \begin{align*}
%   F(n + 1, \ttx) - (1 + \ttx) F(n, \ttx)
%   & = (1 + \ttx) (1 + n\ttx) - (1 + (n + 1) \ttx) \\
%   & = n \ttx^2 
% \end{align*}
$$
P(\ttx) = \frac{p - 1}{2} \ttx + \ttx^2 R(p, p \ttx) 
$$
\begin{align*}
  \left(1 + p \ttx \right)^p
  & = 1 + p^2 \ttx + p^3 \frac{p - 1}{2} \ttx^2 + p^3 \ttx^3 R(p, p\ttx) \\
  & = 1 + p^2 \ttx + p^3 \ttx  Q(\ttx)
\end{align*} 

% $$
%   \left(1 + 2p^{k + 1} \ttx \right)^p
%    = 1 + 2 p^{k + 1} \ttx + 2 p^{k + 3} \ttx Q(2 p^k \ttx)
% $$
% \left(1 + p (\ttx + p \tty)  \right)^p =
% 1 + p^2 \left( \ttx + p \left( \tty + (\ttx + p \tty) Q(\ttx + p \tty) \right) \right) 
% $$
% \begin{align*}
%   \left(1 + p \ttx + p^2 \tty  \right)^p
%   & = \left(1 + p (\ttx + p \tty)  \right)^p \\
%   & = 1 + p^2 ( \ttx + p \tty) +  p^3 (\ttx + p \tty) Q(\ttx + p \tty) \\
%   & = 1 + p^2 \ttx + p^3 \left( \tty + (\ttx + p \tty) Q(\ttx + p \tty) \right)  \\ 
% \end{align*} 
$$
\ttx = 2 p^k (\ttx + p \tty)
$$
$$
\left( 1 + 2p^{k + 1} \ttx  + 2 p^{k + 2} \tty \right)^p
= 1
+ 2 p^{k + 2} \ttx 
+ 2 p^{k + 3} \left(  \ttx + (\ttx + p \tty) Q(2 p^k (\ttx + p \tty)) \right)  
$$

$$
\left( 1 + 2p^{k + 1} \ttx  + 2 p^{k + 2} \tty \right)^p
$$
\begin{theorem}[Hull and Dobell \cite{HullDobell62,Knuth97}] \label{thm:Hull-Dobbel}
Let $a$, $b \in \bZ$ and let $T\colon \bN \to \bZ$ be such that
  $T(n + 1) = a T(n) + b$
  for every $k \in \bN$.
  Let $m \in \bNast$ be such that $\rho'(m)$ divides $a - 1$ and $b$ and $m$ are coprime.
  For every $n$, $n' \in \bN$,
  $T(n) \equiv T(n') \pmod{m}$ is equivalent to $n \equiv n' \pmod{m}$.
\end{theorem}

\begin{theorem} \label{thm:Hull-Dobbel-reverse}
  Let the notation be as in Theorem~\ref{thm:Hull-Dobbel}.
  Assume $m \ne 2$ and that for each $n \in \bZ$, there exists $k \in \bN$ such that $T(k) \equiv n \pmod{m}$.
  Then, $\rho'(m)$ divides $a - 1$ and $b$ and $m$ are coprime.
\end{theorem}

\begin{theorem}
  For every $a \in \bZ$ and every $p \in \bN$ such that $2p$ divides $a - 1$,
  $S(p, a)$ is congruent to $p$ modulo $p^2$.
\end{theorem}


\begin{theorem}
  Let $a \in \bZ$ be such that $4$ divides $a - 1$.
  For every prime factor $p$ of $a - 1$ and every $n \in \bN$,
  the $p$-adic valuation on $S(n, a)$ is equal to that of~$n$.
\end{theorem}

\begin{proof}
  Let $p$ be a prime factor of $a - 1$.
  For each $n \in \bN$, let $\nu(n)$ denote the $p$-adic valuation of $S(n, a)$.
  Let $n \in \bN$ be such that $p$ does not divide~$n$.
  
  Our task is to prove that $\nu$ satisfies the following two properties:
  \begin{enumerate}
  \item For every $n \in \bN$ such that $p$ does not divide $n$,  $\nu(n) = 0$
  \item For every $n \in \bN$, $\nu(pn) = \nu(n) + 1$.
  \end{enumerate}
\end{proof}




\begin{theorem}
    Let $a$, $b \in \bZ$ and let $T\colon \bN \to \bZ$ be such that
    $T(n + 1) = a T(n) + b$
    for every $k \in \bN$.
    Let $p$ be a prime factor of $a - 1$ that does not divide~$b$.
    For every $n$, $k \in \bN$, the $p$-adic valuation of $T(n + k) - T(n)$ is equal to that of $S(k, a)$.
\end{theorem}

\begin{proof}
    Put $b' = T(1) - T(0)$. %= (a - 1) T(0) + b
   %  $$
   % S(k, a) = \frac{T(k) - T(0)}{T(1) - T(0)} 
   % $$
%   We have $a S(k, a) = S(k + 1, a) - 1$ and $a(T(k) - T(0)) = T(k + 1) - T(1)$ for every $k \in \bN$, 
    % Since
    % $$(T(j + 1) - T(j))a = T(j + 2) - T(j + 1)
    % $$
    % for every $j \in \bN$, 
    A straightforward induction on $j$ yields
    $$T(j + 1) - T(j) = b' a^j$$
    for every $j \in \bN$.    
    $$
    T(n + k) - T(k)
%      & = \sum_{j = 0}^{k - 1} \left( T(n + j + 1) - T(n + j) \right)  \\
    = \sum_{j = k}^{n + k - 1} b' a^j
    = \sum_{j = 0}^{k - 1} b' a^{n + j} 
    = b' a^n \sum_{j = 0}^{k - 1}  a^j 
    =  b' a^n S(k, a) 
      %& =  a^n b'  \sum_{j = 0}^{k - 1} a^j \\
%     & = b' a^n  S(k, a) 
$$
      It follows
    \begin{align*}
      T(n + k) - T(k)
%      & = \sum_{j = 0}^{k - 1} \left( T(n + j + 1) - T(n + j) \right)  \\
      & = \sum_{j = 0}^{k - 1} b' a^{n + j} = b' a^n \sum_{j = 0}^{k - 1} a^j 
      %& =  a^n b'  \sum_{j = 0}^{k - 1} a^j \\
      & = b' a^n  S(k, a) 
    \end{align*}
    for every $k \in \bN$.
    A straightforward induction on $n$ yields
    $$
    T(n + k) - T(n) = a^n 
    $$
    for every $n \in \bN$.
    Since $a \equiv 1 \pmod p$ and since $b' = (a - 1) T(0) + b$, 
    $$
    a^n b' \equiv b \pmod{p} 
    $$
    It follows that $p$ does not divide $a^n b'$.
    $$
    \nu_p(T(n + k) - T(n)) = \nu_p(S(k, a)) 
    $$
%    a F(k) + b = a' (a S(k, a) + 1) - a' + a F(0) + b = a' S(k + 1) + F(0)
    % T(n + k) - T(n) = a' S(i, a) - a' S(j, a) = a' a^n S(k, a)
    $$
    T(n + k) - T(n) =  a' a^n S(k, a)
    $$
    $$
    T(i + 1) - T(i) = (a - 1) T(i) + b
    $$
    $$
    T(n + k) - T(n) = \sum_{j = 1}^k T(n + j) - T(n + j - 1) 
    $$
    $$
    a' a^j \equiv b \pmod{\rho(m)} 
    $$
\end{proof}
%\include{maintheorem}


\end{document}

  Equality $u_{n + 1} = a u_n + b$ holds true for every $n \in \bN$
  if, and only if,
  equality
  $$
  f(n) = S(n, a) ((a - 1) u_0 + b)  + u_0
  $$
  holds true for every $n \in \bN$.
Let $m \in \bZ$ and let $X \subseteq \bZ$.
% Let $\equiv$ denote the congruence relation modulo~$m$.
We say that $X$ is a \emph{complete residue system (CRS) modulo $m$}
if for each $y \in \bZ$, there exists a unique $x \in X$ such that $y \equiv x \pmod{m}$.
If $m \ne 0$ then the cardinality of every CRS modulo $m$ is equal to $| m |$.
If $m = 0$ then $\bZ$ is the unique CRS modulo~$m$.
Put
$$
\RS(a) = \left\{ S(n, a) : n \in \bNast \right\}
$$
for each $a \in \bZ$.

\begin{theorem} \label{thm:contains-CRS-implies-rho-divides-m}
  For every $a$, $m \in \bZ$ such that $\RS(a)$ contains a CRS modulo $m$,
  $m$ is non-zero and $\rho'(m)$ divides $a - 1$.
\end{theorem}




\begin{theorem} \label{thm:p-divides-a-1}
  For every $a$, $p \in \bZ$ such that $p$ is prime and $\RS(a)$ contains a CRS modulo $p$,
  $p$ divides $a - 1$.  
\end{theorem}

\begin{proof}
  Let $\equiv$ denote the congruence relation modulo~$p$.
%  Without loss of generality, we may assume $| p | \ne 1$.
  Assume that $\RS(a)$ contains a CRS modulo $p$ and
  that $p$ and $a - 1$ are coprime.
  Then, there exists $i \in \bNast$ such that $S(i, a) \equiv 0$,
  there exists $b \in \bZ$ such that $(a - 1)b \equiv 1$, and subsequently,
  there exists $j \in \bNast$ such that $S(j, a) \equiv - b$.
  On the one hand, we have
  $$
  -  S(i - 1, a) a = 1 - S(i, a) \equiv 1 
  $$
  whence $p$ and $a$ are coprime.
  On the other hand, we have 
  $$
  a^j  - 1 =  (a - 1) S(j, a) \equiv (a - 1) (- b) \equiv - 1 \,,
  $$
  whence $a^j \equiv 0$, or equivalently, $p$ divides $a^j$.
  Therefore, $p$ is not prime.
\end{proof}

\begin{theorem}
  For each $a \in \bZ$ such that $\RS(a)$ contains a CRS modulo $4$,
  $4$ divides $a - 1$.
\end{theorem}

\begin{proof}
  Let $\equiv$ denote the congruence relation modulo~$4$.
  A straightforward induction on $n$ yields
  for every $n \in \bN$.
  It follows $\RS(- 1) = \{ 0, 1 \}$
,
  and thus $\RS(- 1)$ does not contain any CRS modulo~$4$.
  Therefore, if $a \equiv - 1$ then $S(n, a) \equiv 0$ or $S(n, a) \equiv 1$ for every $n \in \bN$.
  It follows $a \equiv - 1$ implies 
  Assume that $\RS(a)$ contains a CRS modulo~$4$.
  Then, Theorem~\ref{thm:p-divides-a-1} ensures that $a - 1$ is even,
  whence $a \equiv 1$ or $a \equiv  - 1$.
   
\end{proof}




\begin{theorem} \label{thm:a-invertible-m}
  Let $a$, $b \in \bZ$, let $m \in \bNtrois$, and let $\left( u_n \right)_{n \in \bN} \in \bZ^{\bN}$ be such that
  $u_{n + 1} = a u_n + b$ for every $n \in \bN$
  and
  $\left\{ u_n : n \in \bN \right\} $ contains a complete residue system modulo~$m$.
  Then, $a$ and $m$ are coprime.
\end{theorem}

\begin{proof}
  Since $m$ is larger than $2$,
  $b - 1$ and $b + 1$ are not congruent modulo $m$, 
  and thus there exists $\varepsilon \in \{ - 1, + 1 \}$ such that $u_0 \not\equiv b + \varepsilon \pmod{m}$.
  Since  $\left\{ u_n : n \in \bN \right\} $ contains a complete residue system modulo $m$,
  there exists $k \in \bN$ such that $u_k \equiv b + \varepsilon \pmod{m}$.
  By construction, $k$ is positive, whence  $u_k = a u_{k - 1} + b$.
  It follows $a  u_{k - 1}  \equiv  \varepsilon  \pmod{m}$
  or equivalently,
  $a  u_{k - 1} \varepsilon  \equiv  1  \pmod{m}$.
  Therefore, $a$ is invertible modulo $m$,
  or equivalently,
  $a$ and $m$ are coprime.
\end{proof}

\begin{theorem}
  Let the notation be as in Theorem~\ref{thm:a-invertible-m}.
  For every $i$, $j \in \bN$,
  $u_i \equiv u_j \pmod{m}$ is equivalent to $i \equiv j \pmod{m}$. 
\end{theorem}

\begin{proof}
  Let $G$ denote the set of those $k \in \bZ$ such that
  for which there exist $i$, $j \in \bN$ such that
   $i - j = k$ implies $u_i \equiv u_j \pmod{m}$.
\end{proof}

  

\begin{theorem} \label{thm:m-odd-prime-divides-a-1}
  Let the notation be as in Theorem~\ref{thm:a-invertible-m}.
  Then, $m$ and $a - 1$ are not coprime.
\end{theorem}

\begin{proof}
  Put $v_n = (a - 1) u_n + b$ for each $n \in \bN$ and $V = \left\{ v_n : n \in \bN \right\}$.
%  If $a - 1$ and $m$ are coprime then $V$ contains a complete residue system modulo~$m$.
 % Therefore, it suffices to check that $V$ does not contain any complete residue system modulo~$m$.
  For each $n \in \bN$, straightforward computations yield
  $$
  v_{n + 1}  = (a - 1)(a u_n + b) + b = a ((a - 1) u_n + b) = a v_n \,, 
  $$
  whence $v_n = a^n v_0$ for every $n \in \bN$.
  First, assume that $v_0$ and $m$ are coprime.
  Since $a$ and $m$ are coprime by Theorem~\ref{ },
  $v_n$ and $m$ are coprime for every $n \in \bN$,
  and thus $V$  does not contain any complete residue system modulo~$m$.
  Now, assume that $v_0$ and $m$ are not coprime.
  Then, we have $v_n \not \equiv 1 \pmod{m}$ for every $n \in \bNast$.
  
  

\end{proof}

\begin{theorem}
  Let the notation be as in Theorem~\ref{thm:a-invertible-m}.
  If $m = 4$ then $4$ divides $a - 1$.
\end{theorem}

\begin{proof}
\end{proof} 



% \include{additional}

 For each $n \in \bZ \setminus \{ 0 \}$, let $\rho(n)$ denote the \emph{radical} of $n$:
 $\rho(n)$ largest square-free divisor of $n$,
 or equivalently,
 $\rho(n)$ is the product of the distinct prime factors of~$n$.
 For instance,  we have $\rho(243936) = 462$ because
 $243936 = 2^5 \times 3^2 \times 7 \times {11}^2$ and
 $462 = 2 \times 3 \times 7 \times 11$.
  % $$
 % \rho'(n) =
 % \begin{cases}
 %   \rho(n) & \text{if $4$ does not divide $n$}  \\
 %   2 \rho(n) & \text{otherwise} 
 % \end{cases}
 % $$
 
 For each $m \in \bNast$,
 let $N(m)$ denote the set of those $n \in \bZ$ that satisfy the following two equivalent properties:
 \begin{enumerate}
 \item Every prime factor of $m$ divides $n$.
 \item There exists $r \in \bN$ such that $m$ divides $n^r$.
 \end{enumerate}
 For each $m \in \bN$, put
 $$
 N'(m) =
 \begin{cases}
   N(m)& \text{if $4$ does not divide $m$} \\
   2 N(m)& \text{if $4$ divides $m$} \\
  \end{cases} 
 $$ 
 
 For each $m \in \bNast$,
let $N(m)$ denote the set of those $n \in \bZ$ that satisfy the following two properties:
  \begin{enumerate}
     \item every prime factor of $m$ divides $n$ and
     \item if $4$ divides $m$ then $4$ divides $n$.
     \end{enumerate}
     
 \begin{exercise}
   \begin{enumerate}
   \item Prove that $N(m)$
   \item Let $m \in \bNast$ be such that $4$ does not divide~$m$.
     Find 
   \item Let $m \in \bNast$, let $r\in \bN$ be such that $m \le 2^r$,  and let $n \in \bZ$.
Prove that every prime factor of $m$ divides $n$ if, and only if, $m$ divides $n^r$.
\item Find a efficient algorithm that  decides
  $$\left\{ (m, n) \in \bNast \times \bZ  : n \in N(m) \right\}$$
   \end{enumerate}  
\end{exercise}

$$
z^d = 0
$$

$$
(\ttx + z)^{k + d} = \sum_{j = 0}^{d - 1}  \binom{k + d}{j} z^j  \ttx^{k + d  - j} 
$$

$$
\ttx^d S(n, \ttx + z) = \sum_{j = 0}^d   \binom{k}{j} z^j \ttx^{n - j}
$$
   $$
   S(n, \ttx) = \sum_{k = 0}^{n - 1} \ttx^k  = \frac{\ttx^n - 1}{\ttx - 1} 
   $$
   


 $$
 S(p, 1 + \ttx) - S(p, 1 + \ttx^2)
 = \frac{{(1 + \ttx)}^p - {(1 + \ttx^2)}^p}{\ttx}
 = 
 $$

 $$
 S(p, 1 + \ttx^k) =  p + \frac{p(p - 1)}{2} \ttx^k  + \ttx^{2k} f(\ttx^k) 
 $$

 $$
 S(p, 1 + \ttx) -  S(p, 1 + \ttx^k)  = \frac{p(p - 1)}{2} \ttx(1 - \ttx^{k - 1}  - 
 $$
 $$
 $$

   $$
   S(n, 1 + \ttx) = \frac{{(1 + \ttx)}^n - 1}{\ttx} = n + \frac{n(n - 1)}{2} \ttx + \ttx^2 f(\ttx) \,,
   $$
  



% The following theorem is only proven for the sake of completeness.



\begin{theorem}
  Let $a$, $m \in \bZ$ be such that $a \in A(m)$.
\end{theorem}

% 1
Assume that $4$ divides $a - 1$.
Then, for each prime factor $p$ of $m$, $2p$ divides $a - 1$.
% 2
Assume that $m$ is odd and that $a - 1$ is even.
Then, for each prime factor $p$ of $m$, $2p$ divides $a - 1$.
% 3
Assume that both $m$ and $a - 1$ are odd.
Then, $a + m - 1$ is even.
Therefore, for each prime factor $p$ of $m$, $2p$ divides $a + m - 1$.
% 4 
Assume that $m$ is even and that $4$ does not divide $a - 1$.
Then, $m \mathbin{/} 2$ is odd, $a - 1$ is even, and ${(a - 1)} \mathbin{/} 2$ is odd.
It follows that $4$ divides $a + m - 1$.
Therefore, for each prime factor $p$ of $m$, $2p$ divides $a + m - 1$.




% $a' = 1 + (a - 1)(m + 1)$
% $a' - 1 = (a - 1)(m + 1)$
$a' = 1 + (2 m + 1)(a - 1)$
$a' - 1 = (2 m + 1)(a - 1)$
 

\begin{theorem}
  For every $a \in \bZ$ and every  $m \in \bN$, 
  every prime factor of $m$ divides $a - 1$ if, and only if, $m$ divides $S(m, a)$.
\end{theorem}

\begin{proof}
  Assume that $m$ divides $S(m, a)$.
  $p$ divides $m$.
  $p$ divides $a^n - 1$
\end{proof}



Put $m = 3$ and $a = 5$.
$$
S(3, 2) = 7
$$
$$
S(3, 5) = 31
$$
$$
S(3, 4) = 21
$$






  
 

 \begin{theorem}
   Let $U$ be a finite set  and let $\left(u_n \right)_{n \in \bN} \in \bZ^\bN$.
   Assume that there exists a function$f\colon U \to U$
   such that  $u_{n + 1} = f(u_n)$ for every $n \in \bN$.
   Let $m$ denote the cardinality of~$U$.
   The following three assertions are equivalent
   \begin{enumerate}
     \item The sets  $U = \{ u_n : n \in \bN \}$ holds true.
     \item The sequence $\left(u_n \right)_{n \in \bN}$ is $m$-periodic.
      \item For every prime factor $p$ of $m$, $u_{m \mathbin{/} p}$ is distinct from $u_0$.
    \end{enumerate}
   \end{theorem}
 
 \begin{theorem}
   Let $m \in \bNast$ and let $\left(u_n \right)_{n \in \bN} \in \bZ^\bN$.
   Assume that there exists $f \colon \bZ \to \bZ$ such that  $u_{n + 1} = f( u_n)$ for every $n \in \bN$.
   The set $\left\{ u_n : n \in \bN \right\}$ contains a complete residue system modulo $m$
   if, and only if,
   the sequence $\left(u_n \bmod m \right)_{n \in \bN}$ is $m$-periodic.
 \end{theorem}


 \begin{theorem} \label{thm:a-and-m-coprime}
   Let $m \in \bN \setminus \{ 0, 2 \}$,
   let $a$, $b \in \bZ$, and
   let $\left(u_n \right)_{n \in \bN} \in \bZ^\bN$ be such that
   $$u_{n + 1} \equiv a u_n + b \pmod m$$
   for every $n \in \bN$.
   \begin{enumerate}
     \item 
       The set $\left\{ u_n : n \in \bN \right\}$ contains a complete residue system modulo~$m$.
      \item 
        The set $\left\{ u_0, u_1, \dotsc, u_{m - 1} \right\}$ is a complete residue system modulo~$m$.
      \item
        For every $i$, $j \in \bN$, $u_i \equiv u_j \pmod m$ is equivalent to $i - j \in m \bZ$.
%        The sequence  $\left(u_n \bmod m  \right)_{n \in \bN}$ is periodic and its least period equals~$m$.
    \end{enumerate} 
 \end{theorem}

 
 \begin{proof}
   Since there is nothing to prove in the case where $m = 1$, we may assume $m \ge 3$ for the rest of the proof.
   Then,
   there exists $\varepsilon \in \{ -1, + 1 \}$ such that $\varepsilon \not \equiv u_0 - b \pmod m$,
   and subsequently,
   there exists $i \in \bN$ such that $u_i \equiv b + \varepsilon \pmod m$.
   By construction, $i$ is positive.
   Put $a' = - \varepsilon u_{i - 1}$.
   We have  $a  u_{i - 1}  \equiv \varepsilon  \pmod m$, or equivalently,
 
   
   

   

  %  Then, there exist $i$, $j \in \bN$ such that
  %  $u_i \ne u_0$,
   
  % $u_j \ne u_0$, and
  % $u_i \ne u_j$.
  % Let $k \in \bN$ be such that $u_k = u_ju_i^{-1}u_0$.
  % By construction, $ijk$ is positive.
  % Let $p \in \bN$ be such that $u_p = u_{i - 1} u_{j - 1}^{-1} u_{k - 1}$.
   Assume that that there exists a prime number $p$ that divides both $b$ and~$m$.
   First,  assume that $p$ divides $a$.
   Then, $p$ divides $u_{n + 1}$ for every $n \in \bN$.
   $$
    u_k \equiv 0
   $$

 
   
   
   Put $d = \gcd(a, m)$.
   $u_k \equiv 1$
   A straightforward induction on $n$ shows that $d$ divides    Assume that there exists a pri
   
 \end{proof}
 

 \begin{theorem} \label{thm:b-and-m-coprime}
   Let the notation be as in Theorem~\ref{thm:a-and-m-coprime}.
   If $\left\{ u_n : n \in \bN \right\}$ contains a complete residue system modulo $m$ then $b$ and $m$ are coprime.
 \end{theorem} 

 \begin{proof}
 

    Assume that  $\left\{ x_n : n \in \bN \right\}$ contains a complete residue system modulo~$m$.
    In particular, there  exists $k \in \bN$ such that $m$ divides $u_k$.
    \end{proof}
  
 \begin{theorem} \label{thm:order-exponent}
   Let $G$ be an abelian group and let $(\alpha, b)$ be a prout of~$G$.
   The order of $b$ equals the exponent of~$G$.
 \end{theorem}

 \begin{proof}

 \end{proof}

 \section{Powers of $2$}
   



 \begin{theorem} \label{thm:4-in-the-middle}
   For every $a \in \bZ$, the following three asertions are equivalent:
%   $a$ is odd, $a^2 \equiv 1 \pmod 4$, and $\nu(a² - 2) = 1$.
 \end{theorem}

 \begin{proof}
   For each $b \in \bZ$, the following three assertions are clearly equivalent:
   $a - 2 = 2 (2b - 1)$,
   $a = 4 b$, and
   $a + 2 = 2 (2b + 1)$.
 \end{proof}


$$
{(1 + x)}^p \equiv 1 + p x \pmod {x^2}
$$
$$
{(1 + q x)}^p \equiv 1 + p q  x  \pmod{q^2 x^2}
$$

$$
s(p, a)
= \frac{a^p - 1}{a - 1}
\equiv p \pmod{a - 1}
$$



$$
S(np, a) = S(n, a^p) S(p, a)
$$

$$
S(np, a) = S(n, a) S(p, a^n) 
$$

$$
\frac{S(np, a)}{npq}  = \frac{S(n, a)}{nq} \frac{S(p, a^{nq})}{p} 
$$



$$
{(1 + q x)}^p \equiv  1 + p q x + \frac{p(p - 1)}{2} q^2  x^2  \pmod{q^3 x^3}
$$

$$
s(p, 1 + q x) = \frac{{(1 + q x)}^p - 1}{q x} \equiv  p  +   \frac{(p - 1)}{2} p q  x \pmod {q^2 x^2}
$$


$$
\frac{s(p, 1 + p x)}{p}  \equiv  1 + p \frac{p - 1}{2} x   \pmod{p x^2}
$$
 
 
 
 \begin{theorem} \label{thm:nu-power-2}
   Let $n \in \bN$ and let $a \in \bZ$.
   If $a \ne 1$ and  $a \equiv 1 \pmod 4$ then $ \nu(a^{2^n} - 1) = \nu(a - 1)  + n$.
 \end{theorem}


 \begin{proof}
   Let $n \in \bN$ be fixed.
   Put $a_n = a^{2^n}$.
   $$
   a_n \equiv 1 \pmod 4
   $$
   and
   $$
   a_{n + 1} - 1 = (a_n - 1) (a_n + 1) \,. 
   $$
   The former equation 
   Besides,  for every  $x \in \bZ$, $x \equiv 2 \pmod 4$ is equivalent to  $\nu(x) = 1$.
   It follows 
   $$
   \nu(a_{n + 1} - 1) = \nu(a_n - 1) + \nu(a_n + 1) = \nu(a_n - 1) + 1
   $$
   
   % A straightforward induc   tion on $n$ yields $a_n \equiv 1 \pmod 4$ for every $n \in \bN$.

   Therefore, equality 
   For each $n \in \bN$,
   we thus have  $\nu(a_n + 1) = 1$, and consequently
   $$
   \nu(a_{n + 1} - 1) = \nu(a_n - 1) + 1 
   $$
   because
   $$
   a_{n + 1} - 1 = (a_n - 1) (a_n + 1) \,.
   $$
   The desired result follows from the latter equation and a straightforward induction on~$n$.
 \end{proof}

 
 \begin{theorem} \label{thm:nu-power-2}
   For every $n \in \bNast$ and every odd $a \in \bZ$,
   equality
   $$
   \nu(a^{2^n} - 1) = \nu(a - 1) + \nu(a + 1) - 1 + n 
   $$
   holds true.
 \end{theorem}


 \begin{proof}
   Put $a_n = a^{2^n}$ for each $n \in \bN$.
   Since 
   \begin{equation} \label{eq:xn-rec-xn+1-1}
   a_{n + 1} - 1 = (a_n - 1) (a_n + 1) 
   \end{equation}
   for every  $n \in \bN$,
   a straightforward induction on $n$ yields
   $$
   a_n - 1 = (a - 1)(a + 1) \prod_{k = 1}^{n - 1} (a_k + 1) 
   $$
   for every $n \in \bNast$.
   It remains to prove $\nu(a_k + 1) = 1$ for each $k \in \bNast$.
   Let $n \in \bN$ be fixed.
   Since the set of all odd integers is closed under multiplication,
   $a_n$ is odd.
   Therefore, both $a_n - 1$ and $a_n + 1$  are even,
   and thus Equation~\eqref{eq:xn-rec-xn+1-1} ensures that $4$ divides
   $a_{n + 1} - 1 = (a_{n + 1} + 1) - 2$.
   % Besides,  for every $y \in \bZ$, $\nu(y)$ equals $1$ if, and only if, $4$ divides $y - 2$.
   Therefore Theorem~\ref{thm:4-in-the-middle} ensures  $\nu(a_{n + 1} + 1) = 1$.
 \end{proof}

  \begin{theorem}
    Let $n \in \bN$, let $a \in \bZ$, and let $\varepsilon \in \{ -1, + 1 \}$ be such that
    $a \equiv \varepsilon \pmod 4$ and
    $a \not \equiv \varepsilon \pmod{2^n}$.
    The multiplicative order of $a$ modulo $2^n$ equals $2^{n - \nu(a - \varepsilon)}$.
  \end{theorem}
  
  \begin{proof}
    If $n < 3$ then there is nothing to prove.
    Put $m = n - \nu(a - \varepsilon)$ and $M = 2^{m - 1}$.
    Since $2^n$ does not divide $a - \varepsilon$,
    $m$ is a positive integer, and thus
    Theorem~\ref{thm:nu-power-2} ensures $\nu(a^{2M} - 1) = n$
    It follows $a^{2M} \equiv 1 \pmod{2^n}$, or equivalently, 
    the multiplicative order of $a$ modulo $2^n$ divides $2M = 2^m$.
    It remains to prove $a^M \not \equiv 1 \pmod{2^n}$.
    Let us first assume $\varepsilon = 1$ or $m > 1$.
    Then, Theorem~\ref{thm:nu-power-2} ensures $\nu(a^M - 1) = n - 1$, whence $a^M \not \equiv 1 \pmod{2^n}$
    Let us now assume $\varepsilon = - 1$ and $m = M = 1$.
     $a \equiv - 1 \pmod 4$
    $a \not \equiv 1 \pmod{2^n}$   
    
  \end{proof}

 \begin{theorem}
   Let $\phi\colon \bZ \times \bZ \to \bZ$ be defined by:
   $\phi(x, y) = {(- 1)}^x 5^y$ for every $x$, $y \in \bZ$.
   For each $n \in \bN$, $\phi$ induces an isomorphism
   from the additive group $(\bZ / 2  \bZ) \times (\bZ / 2^n \bZ)$
   onto
   the multiplicative subgroup $\bZ / 2^{n + 2} \bZ$.
 \end{theorem}

 \begin{proof}
   $$
   \nu(5^{2^{n}} - 1) = \nu(4) + \nu(6) - 1  + n  = 2 + 1 - 1 + n = n + 2
   $$
   $$
   \nu(5^{2^{n - 1}} - 1) = \nu(4) + \nu(6) - 1  + (n - 1)  = 2 + 1 - 1 + (n - 1) = n + 1
   $$
 \end{proof}



  
 \begin{theorem}
   For every $n \in \bN \setminus \{ 0, 1 \}$ and every $a \in \bZ$,
   $\left\{  s_k(a) : k \in \bN \right\}$ contains a complete residue system modulo $2^n$  if, and only if,
   $4$ divides $a - 1$.
 \end{theorem}

 \begin{proof}
   Let $n \in \bN \setminus \{ 0, 1 \}$ and let $a \in \bZ$ be fixed.
   For each $x \in \bZ$, let $\bar x$ denote the residue class of $x$ modulo $2^n$.
   Our task is to prove that the period of $\left\{  s_k(\bar a) : k \in \bN \right\} = \bZ / 2^n \bZ$
   if, and only if, $4$ divides $a - 1$.    
   
 \end{proof}
 
 

 \begin{theorem}
   Let $n \in \bN$ and $x \in \bZ$ be odd.
   \begin{enumerate}
   \item $2^{n + 2}$ divides $x^{2^n} - 1$.
   \item $2^{n + 1}$ does not divide $x^{2^n} - 1$ if, and only if, $8$ divides $x - 5$.
   \end{enumerate}  
 \end{theorem}


 

 \begin{theorem}
   For each $n \in \bN$, the  additive group  $(\bZ / 2^n \bZ) \times (\bZ / 2 \bZ)$ admits a prout
   if, and only if, $n$ is not greater than~$1$.
 \end{theorem}

 \begin{proof}
   Put $G = (\bZ / 2^n \bZ) \times (\bZ / 2 \bZ)$.
   By Theorem~\ref{ } the order of $b$ equals $2^n$.
   Let $u$, $v \in G$ be such that $G = \bZ u + \bZ v$ and $2^n u = 2 v = 0$.
   $$
   \left\{ g \in G : 2 g = 0 \right\}  = \left\{ 0, v, 2^{n - 1} u, 2^{n - 1} u + v  \right\} 
   $$

   $$
   \left\{ g \in G : 2^{n - 1} g \ne 0 \right\}  = \left\{ (2 k + 1) u  \right\} 
   $$
   

   Let $(\alpha, b)$ be a prout of~
   $b = i u + j v$
   
   $\alpha(b) =  k u + v $
    

  
   

 
   
   
   % Let $\alpha\colon G \to G$ be defined by:
 
   % Let $n \in \bN \setminus \{ 0, 1 \}$ be fixed.
   % Put $G 
   % For each $n
   % Let $u$, $v \in G$ such that $G = \bZ u + \bZ v$

 
   % The order of $k u + v$ (resp.~$k u$) equals $2^n$ if and only if, $k$ is odd.
   

   % Exactly $3$ elements of $G$ are of order $2$:
   % $v$, $2^{n - 1} u$, and $2^{n - 1} u + v$.

   % $$
   % \alpha(2^{n - 1} u) = 2^{n - 1} \alpha(u) = 2^{n - 1} u
   % $$
   
   % +  v                v
   % + 2^{n - 1} u + v = 2^{n - 1} u 
   % + v               = 2^{n - 1} u + v   
   % + 2^{n - 1} u + v = 0
   % + v               = v 
   % + 2^{n - 1} u + v
   % + v
   % Assume $\alpha(v) = 2^{n - 1} u  + v$.
   
   % $$
   % \alpha ( 2^{n - 1} u  + v) = \alpha(2^{n - 1} u) + \alpha(v) = 2^{n - 1} u + \alpha(v)
   % $$

   % $\alpha$ is not injective.

   % $$
   % \alpha(u) = m u + v
   % $$

   % $$
   % \alpha^2(u) = m^2 u + v + \alpha(v)
   % $$

   % $$
   % \alpha^k(u) = m^k u + \sum_{j = 0}^k \alpha^k(v) 
   % $$

   
   
 \end{proof}
 
 
\begin{theorem} 
  Let $G$ be a multiplicative monoid,
  let $\alpha$ be an endomorphism of $G$,
  let $b$, $c \in G$, and
  let $\left( g_n \right)_{n \in \bN} \in G^\bN$ be such that $b \alpha(g_0) = g_0 c$.
  Equality $g_{n + 1} = b \alpha(g_n)$ holds true for every $n \in \bN$ if, and only if, 
  equality $g_{n + 1} = g_n \alpha^n(c)$ holds true for every $n \in \bN$.
\end{theorem}

\begin{proof}
  Put $b_n  = b \alpha(g_n)$ and $c_n =  g_n \alpha^n(c)$ for each $n \in \bN$.
  Equality $b_0  =  c_0$ holds true by assumption,
  and for each $n \in \bN$ such that $g_{n + 1} = b_n = c_n$,
  straightforward computations yield
  $$
  b_{n + 1} = b \alpha(g_{n + 1})
  = b \alpha (g_n \alpha^n(c))
  = b \alpha(g_n) \alpha^{n + 1}(c)
  = g_{n + 1}  \alpha^{n + 1}(c) = c_{n + 1}  \,.
  $$
  Therefore,
  if equality $g_{n + 1} = b_n$ holds true for every $n \in \bN$
  then it follows from a simple induction on $n$  equality $g_{n + 1} = c_n$ holds true for every $n \in \bN$.
  
  % Let $\left( b_n \right)_{n \in \bN} \in G^\bN$ be given by:
  % $b_0 = g_0$ and $b_{n + 1} = b \alpha(b_n)$ for every $n \in \bN$.
  % Let $\left( c_n \right)_{n \in \bN} \in G^\bN$ be given by:
  % $c_0 = g_0$ and $c_{n + 1} = c_n \alpha^n(c)$ for every $n \in \bN$.
  Put $c_n =  \alpha^n(c)$ for each $n \in \bN$, 
  $$
  B = \left\{ n \in \bN :g_{n + 1} = b \alpha(g_n) \right\} \,,  
  $$
  and
  $$
  C = \left\{ n \in \bN :g_{n + 1} = g_n c_n \right\} \, .  
  $$
  % Let $B$ denote the set of those $n \in \bN$ such that $g_{n + 1} = b \alpha(g_n)$ and 
  % let $C$ denote the set of those $n \in \bN$ such that $g_{n + 1} = g_n \alpha^n(c)$.
  Our task is to prove that $B = \bN$ is equivalent to $C = \bN$.
  Since $b \alpha(g_0) = g_0 c_0$ by assumption,
  $0 \in B$ is equivalent to $0 \in C$.
  Moreover, for each $n \in B \cap C$,
  straightforward computations yield
  $$
  b \alpha(g_{n + 1})
  = b \alpha (g_n c_n)
  = b \alpha(g_n) c_{n + 1}
  = g_{n + 1} c_{n + 1} \,, 
  $$
  whence $n + 1 \in B$ is equivalent to $n + 1 \in C$.
  Moreover, for each $n \in C$ such that $\{ n, n + 1 \} \subseteq B$,
  straightforward computations yield
  $$
  g_{n + 2}
  = b \alpha(g_{n + 1})
  = b \alpha (g_n c_n)
  = b \alpha(g_n) c_{n + 1}
  = g_{n + 1} c_{n + 1} \,, 
  $$
  whence $n + 1 \in C$.
  Therefore, $B = \bN$ implies $C = \bN$.
  It remains to prove the converse.
  For each $n \in B$ such that $\{ n, n + 1 \} \subseteq C$, straightforward computations yield
  $$
  g_{n + 2}
  = g_{n + 1} c_{n + 1} 
  = b \alpha(g_n) c_{n + 1} 
  = b \alpha\left(g_n c_n  \right)
  = b \alpha(g_{n + 1}) \,, 
  $$
  whence $n + 1 \in B$.
  Therefore, $C = \bN$ implies $B = \bN$.
\end{proof}


\begin{theorem}
  Let $G$ be an additive commutative monoid,
  let $\alpha$ be an endomorphism of $G$,
  let $b$, $c \in G$, and
  let $\left( g_n \right)_{n \in \bN} \in G^\bN$ be such that $\alpha(g_0) + b  = g_0 + c$.
  Equality $g_{n + 1} = \alpha(g_n) + b$ holds true for every $n \in \bN$ if, and only if, 
  equality
  $$g_n = g_0 + \sum_{k = 0}^{n - 1}  \alpha^k(c)
  $$
  holds true for every $n \in \bN$.
\end{theorem}



Put $c_n = \alpha^n(c)$.


$g_{n + 1} = b \alpha(g_n)$

$h_{n + 1} = h_n c_n$

Assume $g_n = h_n$ and $g_{n + 1} = h_{n + 1}$
$$
g_{n + 1} = h_n c_n 
$$


Put $b_n = \alpha^n(b)$ and $c_n = \alpha^n(c)$ for every $n \in \bN$.

$$
b_n \alpha^{n + 1}(g_0) = \alpha^n(g_0) c_n
$$

$$
g_n = b_0 b_1 b_2 \dotsm b_{n - 1}  \alpha^n(g_0)
$$

$$
g_n = g_0 c_0 c_1 c_2 \dotsm c_{n - 1} 
$$





$$
S(\ttx) = \sum_{k = 0}^{q - 1} {(1 + \ttx)}^k 
$$

$$
\ttx S(\ttx) = {(1 + \ttx)}^q - 1
$$

$$
{(1 + \ttx)}^q = 1 + \ttx^q 
$$

$$
\ttx S(\ttx)  = \ttx^q 
$$

$$
S(\ttx)  = \ttx^{q - 1}  
$$


\end{document}

% three equivalent properties:
% \begin{enumerate}
% \item

% \item
%   The cardinality of $X$ is not greater than $| m |$ and,
%   for each $y \in \bZ$, there exists at least one $x \in X$ such that $y \equiv x \pmod{m}$.
% \item
%   The cardinality of $X$ is not less than $| m |$ and,
%   for every $x$, $x' \in X$, $x \equiv x' \pmod{m}$ implies $x = x'$.
% \end{enumerate}

\begin{theorem}[Hull and Dobell \cite{HullDobell62,Knuth97}] \label{thm:Hull-Dobbel}
  Let $m \in \bNast$, let $a$, $b \in \bZ$, and let $F\colon \bN \to \bZ$ be such that
  $F(k + 1) = a F(k) + b$
  for every $k \in \bN$.
  The following three assertions  are equivalent:
  \begin{enumerate}
    \item  For every $i$, $j \in \bN$,
      $F(i) \equiv F(j) \pmod{m}$ is equivalent to $i \equiv j \pmod{m}$.
%      $m$ divides $F(i) - F(j)$ if, and only if, $m$ divides $i - j$. 
    \item $\rho'(m)$ divides $a - 1$ and $b$ and $m$ are coprime.
    \item For each $n \in \bZ$, there exists $k \in \bNast$ such that $F(k) \equiv n \pmod{m}$.
    \end{enumerate}
  \end{theorem}